<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Загрузка файла</title>
    <script>
        function validateForm() {
            var count_podh = document.getElementById('count_podh').value;
            var timeInputs = document.querySelectorAll('input[name="time"]');
        
            if (count_podh == 0 || count_podh == "" || !/^\d+$/.test(count_podh)) {
                alert("Количество подходов не может быть равно 0 или быть пустым.");
                return false;
            }
        
            for (var i = 0; i < timeInputs.length; i++) {
                if (timeInputs[i].value <= 0 || timeInputs[i].value == ""  || isNaN(timeInputs[i].value)) {
                    alert("Время выполнения должно быть положительным числом.");
                    return false;
                }
            }
        
            return true;
        }
        
    </script>
    <link rel="stylesheet" type="text/css" href="/static/viewingtr.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <a href="../">
        <svg class="arrow-left-5" viewBox="0 0 154 109">
            <symbol id="Arrow" viewBox="-73.9 -55.3 135.9 85.4">
                <g>
                    <polygon points="-73.9,29.1 -6,-9.2 61.9,30.1 61.9,14.2 -6,-25.1 -73.9,14.2 "/>
                </g>
                <g>
                    <polygon points="-73.9,-1 -6,-39.3 61.9,0 61.9,-16 -6,-55.3 -73.9,-16 "/>
                </g>
            </symbol>
            <use xlink:href="#Arrow" width="135.9" height="85.4" id="XMLID_1_" x="-73.9" y="-55.3" transform="matrix(1.007 0 0 -1.007 83.0005 42)" />
        </svg>
    </a>
    <form action="/save_tr/{{ filename }}" method="post" onsubmit="return validateForm()">
        <h1>Редактирование тренировки:</h1>
        <label for="name">Название:</label>
        <input type="text" id="name" name="name" value="{{ exercise_content['name'] }}" required>
        <label for="count_podh">Количество подходов:</label>
        <input type="text" id="count_podh" name="count_podh" value="{{ exercise_content['count_podh'] }}" required>
        <br>
        <label for="exercise">Упражнения:</label>
        <div id="exercises">
            {% for exercise in exercise_content['exercises'] %}
                <h2>{{ exercise['name_ypr'] }}</h2>
                <label for="exercise">Время выполнения:</label>
                <input type="text" id="time" name="time" value="{{ exercise['time'] }}" required>
                <a href="/delete_tr/{{ filename }}/{{ exercise['number_of_line'] }}"class="button">Удалить</a>
                <input type="hidden" id="file" name="file" value="{{ exercise['file'] }}" required>
                <input type="hidden" id="number_of_line" name="number_of_line" value="{{ exercise['number_of_line'] }}" required>
            {% endfor %}
        </div>
        <h2>Выберите упражнение для добавления:</h2>
        {% for name_of_file, content in exercise.items() %}
            <p>{{ content['name'] }}</p>
            <button type="submit" formaction="/add_exercise/{{ filename }}/{{ name_of_file }}">+</button>
        {% endfor %}
        <button type="submit">Сохранить</button>
    </form>

</body>
</html>
